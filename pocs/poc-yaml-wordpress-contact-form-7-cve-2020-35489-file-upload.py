import requests,re,urllib3
from packaging import version
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
def find_plugin_version(str_response):
    ver_lo = str_response.find("Stable tag:")
    return(str_response[ver_lo+12:ver_lo+32].split()[0])
def scan(baseurl):
	url=baseurl+"wp-content/plugins/contact-form-7/readme.txt"
	headers={"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0"}
	response=requests.get(url,headers=headers,timeout=5,verify=False)
	version_ = find_plugin_version(response.text)
	if response.status_code == 200 and response.text.startswith("=== Contact Form 7 ===") and version.parse(version_) < version.parse("5.3.2"):
		r0=True
	else:
		r0=False
	if r0:
		return True
	else:
		return False
